2022-01-18 19:33:08,447 - root - Namespace(accumulate_grad_batches=4, adam_epsilon=1e-08, amp_backend='native', amp_level='O2', auto_lr_find=False, auto_scale_batch_size=False, auto_select_gpus=False, batch_size=10, benchmark=False, bert_config_dir='/nfs/yding4/AVE_project/mrc-for-flat-nested-ner/yd_data/bert-base-cased', bert_dropout=0.1, check_val_every_n_epoch=1, checkpoint_callback=True, chinese=False, classifier_act_func='gelu', classifier_intermediate_hidden_size=2048, data_dir='/nfs/yding4/AVE_project/consumable/title_bullet/33att/sample_data_1/mrc_for_ner/33att/', default_root_dir='/nfs/yding4/AVE_project/mrc-for-flat-nested-ner/yd_script/01_18_2021/train_mrc_for_ner/mrc_ner', deterministic=False, distributed_backend='ddp', early_stop_callback=False, fast_dev_run=False, final_div_factor=10000.0, flat=True, gpus=2, gradient_clip_val=1.0, limit_test_batches=1.0, limit_train_batches=1.0, limit_val_batches=1.0, log_gpu_memory=None, log_save_interval=100, logger=True, lr=3e-05, lr_mini=3e-07, lr_scheduler='polydecay', max_epochs=20, max_keep_ckpt=3, max_length=200, max_steps=None, min_epochs=1, min_steps=None, mrc_dropout=0.3, num_nodes=1, num_processes=1, num_sanity_val_steps=2, optimizer='torch.adam', overfit_batches=0.0, overfit_pct=None, precision=16, prepare_data_per_node=True, pretrained_checkpoint='', process_position=0, profiler=None, progress_bar_refresh_rate=1, reload_dataloaders_every_epoch=False, replace_sampler_ddp=True, resume_from_checkpoint=None, row_log_interval=50, seed=0, span_loss_candidates='pred_and_gold', sync_batchnorm=False, terminate_on_nan=False, test_percent_check=None, tpu_cores=<function Trainer._gpus_arg_default at 0x7fd54174cc10>, track_grad_norm=-1, train_percent_check=None, truncated_bptt_steps=None, val_check_interval=0.2, val_percent_check=None, warmup_steps=0, weight_decay=0.01, weight_end=1.0, weight_span=0.1, weight_start=1.0, weights_save_path=None, weights_summary='top', workers=0)
2022-01-18 19:33:08,447 - __main__ - Namespace(accumulate_grad_batches=4, adam_epsilon=1e-08, amp_backend='native', amp_level='O2', auto_lr_find=False, auto_scale_batch_size=False, auto_select_gpus=False, batch_size=10, benchmark=False, bert_config_dir='/nfs/yding4/AVE_project/mrc-for-flat-nested-ner/yd_data/bert-base-cased', bert_dropout=0.1, check_val_every_n_epoch=1, checkpoint_callback=True, chinese=False, classifier_act_func='gelu', classifier_intermediate_hidden_size=2048, data_dir='/nfs/yding4/AVE_project/consumable/title_bullet/33att/sample_data_1/mrc_for_ner/33att/', default_root_dir='/nfs/yding4/AVE_project/mrc-for-flat-nested-ner/yd_script/01_18_2021/train_mrc_for_ner/mrc_ner', deterministic=False, distributed_backend='ddp', early_stop_callback=False, fast_dev_run=False, final_div_factor=10000.0, flat=True, gpus=2, gradient_clip_val=1.0, limit_test_batches=1.0, limit_train_batches=1.0, limit_val_batches=1.0, log_gpu_memory=None, log_save_interval=100, logger=True, lr=3e-05, lr_mini=3e-07, lr_scheduler='polydecay', max_epochs=20, max_keep_ckpt=3, max_length=200, max_steps=None, min_epochs=1, min_steps=None, mrc_dropout=0.3, num_nodes=1, num_processes=1, num_sanity_val_steps=2, optimizer='torch.adam', overfit_batches=0.0, overfit_pct=None, precision=16, prepare_data_per_node=True, pretrained_checkpoint='', process_position=0, profiler=None, progress_bar_refresh_rate=1, reload_dataloaders_every_epoch=False, replace_sampler_ddp=True, resume_from_checkpoint=None, row_log_interval=50, seed=0, span_loss_candidates='pred_and_gold', sync_batchnorm=False, terminate_on_nan=False, test_percent_check=None, tpu_cores=<function Trainer._gpus_arg_default at 0x7fd54174cc10>, track_grad_norm=-1, train_percent_check=None, truncated_bptt_steps=None, val_check_interval=0.2, val_percent_check=None, warmup_steps=0, weight_decay=0.01, weight_end=1.0, weight_span=0.1, weight_start=1.0, weights_save_path=None, weights_summary='top', workers=0)
2022-01-18 19:33:08,449 - lightning - GPU available: True, used: True
2022-01-18 19:33:08,450 - lightning - TPU available: False, using: 0 TPU cores
2022-01-18 19:33:08,450 - lightning - CUDA_VISIBLE_DEVICES: [0,1]
2022-01-18 19:33:08,450 - lightning - Using native 16bit precision.
2022-01-18 19:33:11,708 - lightning - initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/2
2022-01-18 19:33:14,393 - root - Namespace(accumulate_grad_batches=4, adam_epsilon=1e-08, amp_backend='native', amp_level='O2', auto_lr_find=False, auto_scale_batch_size=False, auto_select_gpus=False, batch_size=10, benchmark=False, bert_config_dir='/nfs/yding4/AVE_project/mrc-for-flat-nested-ner/yd_data/bert-base-cased', bert_dropout=0.1, check_val_every_n_epoch=1, checkpoint_callback=True, chinese=False, classifier_act_func='gelu', classifier_intermediate_hidden_size=2048, data_dir='/nfs/yding4/AVE_project/consumable/title_bullet/33att/sample_data_1/mrc_for_ner/33att/', default_root_dir='/nfs/yding4/AVE_project/mrc-for-flat-nested-ner/yd_script/01_18_2021/train_mrc_for_ner/mrc_ner', deterministic=False, distributed_backend='ddp', early_stop_callback=False, fast_dev_run=False, final_div_factor=10000.0, flat=True, gpus=2, gradient_clip_val=1.0, limit_test_batches=1.0, limit_train_batches=1.0, limit_val_batches=1.0, log_gpu_memory=None, log_save_interval=100, logger=True, lr=3e-05, lr_mini=3e-07, lr_scheduler='polydecay', max_epochs=20, max_keep_ckpt=3, max_length=200, max_steps=None, min_epochs=1, min_steps=None, mrc_dropout=0.3, num_nodes=1, num_processes=1, num_sanity_val_steps=2, optimizer='torch.adam', overfit_batches=0.0, overfit_pct=None, precision=16, prepare_data_per_node=True, pretrained_checkpoint='', process_position=0, profiler=None, progress_bar_refresh_rate=1, reload_dataloaders_every_epoch=False, replace_sampler_ddp=True, resume_from_checkpoint=None, row_log_interval=50, seed=0, span_loss_candidates='pred_and_gold', sync_batchnorm=False, terminate_on_nan=False, test_percent_check=None, tpu_cores=<function Trainer._gpus_arg_default at 0x7f0c2196ec10>, track_grad_norm=-1, train_percent_check=None, truncated_bptt_steps=None, val_check_interval=0.2, val_percent_check=None, warmup_steps=0, weight_decay=0.01, weight_end=1.0, weight_span=0.1, weight_start=1.0, weights_save_path=None, weights_summary='top', workers=0)
2022-01-18 19:33:14,393 - __main__ - Namespace(accumulate_grad_batches=4, adam_epsilon=1e-08, amp_backend='native', amp_level='O2', auto_lr_find=False, auto_scale_batch_size=False, auto_select_gpus=False, batch_size=10, benchmark=False, bert_config_dir='/nfs/yding4/AVE_project/mrc-for-flat-nested-ner/yd_data/bert-base-cased', bert_dropout=0.1, check_val_every_n_epoch=1, checkpoint_callback=True, chinese=False, classifier_act_func='gelu', classifier_intermediate_hidden_size=2048, data_dir='/nfs/yding4/AVE_project/consumable/title_bullet/33att/sample_data_1/mrc_for_ner/33att/', default_root_dir='/nfs/yding4/AVE_project/mrc-for-flat-nested-ner/yd_script/01_18_2021/train_mrc_for_ner/mrc_ner', deterministic=False, distributed_backend='ddp', early_stop_callback=False, fast_dev_run=False, final_div_factor=10000.0, flat=True, gpus=2, gradient_clip_val=1.0, limit_test_batches=1.0, limit_train_batches=1.0, limit_val_batches=1.0, log_gpu_memory=None, log_save_interval=100, logger=True, lr=3e-05, lr_mini=3e-07, lr_scheduler='polydecay', max_epochs=20, max_keep_ckpt=3, max_length=200, max_steps=None, min_epochs=1, min_steps=None, mrc_dropout=0.3, num_nodes=1, num_processes=1, num_sanity_val_steps=2, optimizer='torch.adam', overfit_batches=0.0, overfit_pct=None, precision=16, prepare_data_per_node=True, pretrained_checkpoint='', process_position=0, profiler=None, progress_bar_refresh_rate=1, reload_dataloaders_every_epoch=False, replace_sampler_ddp=True, resume_from_checkpoint=None, row_log_interval=50, seed=0, span_loss_candidates='pred_and_gold', sync_batchnorm=False, terminate_on_nan=False, test_percent_check=None, tpu_cores=<function Trainer._gpus_arg_default at 0x7f0c2196ec10>, track_grad_norm=-1, train_percent_check=None, truncated_bptt_steps=None, val_check_interval=0.2, val_percent_check=None, warmup_steps=0, weight_decay=0.01, weight_end=1.0, weight_span=0.1, weight_start=1.0, weights_save_path=None, weights_summary='top', workers=0)
2022-01-18 19:33:14,394 - lightning - Using native 16bit precision.
2022-01-18 19:33:14,395 - lightning - initializing ddp: GLOBAL_RANK: 1, MEMBER: 2/2
2022-01-18 19:33:20,430 - lightning - ----------------------------------------------------------------------------------------------------
2022-01-18 19:33:20,430 - lightning - distributed_backend=ddp
2022-01-18 19:33:20,430 - lightning - All DDP processes registered. Starting ddp with 2 processes
2022-01-18 19:33:20,430 - lightning - ----------------------------------------------------------------------------------------------------
2022-01-18 19:35:11,373 - lightning - 
  | Name     | Type              | Params
-----------------------------------------------
0 | model    | BertQueryNER      | 111 M 
1 | bce_loss | BCEWithLogitsLoss | 0     
2 | span_f1  | QuerySpanF1       | 0     
2022-01-18 19:35:14,126 - __main__ - EVAL INFO -> current_epoch is: 0, current_global_step is: 0 
2022-01-18 19:35:14,126 - __main__ - EVAL INFO -> valid_f1 is: 0.0007917656912468374; precision: 0.00039635354187339544, recall: 0.3333333432674408.
2022-01-18 19:35:14,143 - __main__ - EVAL INFO -> current_epoch is: 0, current_global_step is: 0 
2022-01-18 19:35:14,143 - __main__ - EVAL INFO -> valid_f1 is: 0.0007917656912468374; precision: 0.00039635354187339544, recall: 0.3333333432674408.
